#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Telegram –ë–æ—Ç –¥–ª—è –ë–µ–≥–æ–≤–æ–≥–æ –°–æ–æ–±—â–µ—Å—Ç–≤–∞
–§—É–Ω–∫—Ü–∏–∏: –£—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –ü–æ–≥–æ–¥–∞, –¢–µ–º—ã –¥–Ω—è, –ê–Ω–æ–Ω–∏–º–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞, –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞
"""

import os
import asyncio
import logging
import threading
import time
import random
import httpx
import signal
import sys
from datetime import datetime, timedelta
from telegram import Update
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    MessageHandler,
    ContextTypes,
    CallbackQueryHandler,
    filters,
)
import pytz
from flask import Flask

# ============== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==============
BOT_TOKEN = os.environ.get("TELEGRAM_BOT_TOKEN")
if not BOT_TOKEN:
    raise ValueError("–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!")

RENDER_URL = os.environ.get("RENDER_URL", "")

CHAT_ID = os.environ.get("CHAT_ID")
if not CHAT_ID:
    raise ValueError("CHAT_ID –Ω–µ –Ω–∞–π–¥–µ–Ω!")

try:
    CHAT_ID = int(CHAT_ID)
except ValueError:
    raise ValueError("CHAT_ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º!")

MOSCOW_TZ = pytz.timezone("Europe/Moscow")

logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    level=logging.INFO,
)
logger = logging.getLogger(__name__)

# ============== FLASK ==============
app = Flask(__name__)


@app.route("/")
def home():
    return "Bot is running!"


@app.route("/health")
def health():
    return "OK"


def run_flask():
    app.run(host="0.0.0.0", port=10000)


# ============== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==============
application = None
morning_message_id = None
morning_scheduled_date = ""
bot_running = True
motivation_sent_times = []

# ============== –ù–û–ß–ù–û–ô –†–ï–ñ–ò–ú ==============
night_messages_count = 0
night_warning_sent = False

# ============== –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –í–û–ó–í–†–ê–©–ï–ù–¶–ï–í ==============
# {user_id: last_active_date}
user_last_active = {}

# ============== –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–õ–Ø –ï–ñ–ï–î–ù–ï–í–ù–û–ô –°–í–û–î–ö–ò ==============
daily_stats = {
    "date": "",
    "total_messages": 0,
    "user_messages": {},  # {user_id: {"name": str, "count": int}}
    "photos": [],  # [{"file_id": str, "user_id": int, "likes": int, "message_id": int}]
}
daily_summary_sent = False

# ============== –î–ê–ù–ù–´–ï ==============
DAY_THEMES = {
    "Monday": "üéµ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ ‚Äî –¥–µ–Ω—å –º—É–∑—ã–∫–∏! –ö–∞–∫–∞—è –ø–µ—Å–Ω—è –∑–∞–≤–æ–¥–∏—Ç —Ç–µ–±—è –Ω–∞ –ø—Ä–æ–±–µ–∂–∫—É?",
    "Tuesday": "üêï –í—Ç–æ—Ä–Ω–∏–∫ ‚Äî –¥–µ–Ω—å –ø–∏—Ç–æ–º—Ü–µ–≤! –ü–æ–∫–∞–∂–∏ —Å–≤–æ–µ–≥–æ —á–µ—Ç–≤–µ—Ä–æ–Ω–æ–≥–æ–≥–æ –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞!",
    "Wednesday": "üíù –°—Ä–µ–¥–∞ ‚Äî –¥–µ–Ω—å –¥–æ–±—Ä—ã—Ö –¥–µ–ª! –ü–æ–¥–µ–ª–∏—Å—å, –∫–æ–º—É —Ç—ã —Å–µ–≥–æ–¥–Ω—è –ø–æ–º–æ–≥!",
    "Thursday": "üçï –ß–µ—Ç–≤–µ—Ä–≥ ‚Äî –¥–µ–Ω—å –µ–¥—ã! –ß—Ç–æ —Ç—ã –µ—à—å –ø–µ—Ä–µ–¥ –∏ –ø–æ—Å–ª–µ –ø—Ä–æ–±–µ–∂–∫–∏?",
    "Friday": "üì∏ –ü—è—Ç–Ω–∏—Ü–∞ ‚Äî –¥–µ–Ω—å —Å–µ–ª—Ñ–∏! –ü–æ–∫–∞–∂–∏ —Å–≤–æ—ë –ª–∏—Ü–æ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏!",
    "Saturday": "üò© –°—É–±–±–æ—Ç–∞ ‚Äî –¥–µ–Ω—å –Ω—ã—Ç—å—è! –†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è –±—ã–ª–æ —Ç—è–∂–µ–ª–æ!",
    "Sunday": "üì∑ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Äî –¥–µ–Ω—å –Ω—é–¥—Å–æ–≤! –ü–æ–∫–∞–∂–∏ –∫—Ä–∞—Å–∏–≤—ã–µ –≤–∏–¥—ã —Å –ø—Ä–æ–±–µ–∂–∫–∏!",
}

WELCOME_MESSAGES = [
    "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –±–µ–≥–æ–≤–æ–π –º—É—Ä–∞–≤–µ–π–Ω–∏–∫! –¢—ã —É–∂–µ –≤—ã–±—Ä–∞–ª —Å–≤–æ—é –¥–∏—Å—Ç–∞–Ω—Ü–∏—é: 5 –∫–º –¥–ª—è —Ä–∞–∑–º–∏–Ω–∫–∏, –ø–æ–ª—É–º–∞—Ä–∞—Ñ–æ–Ω –¥–ª—è –¥—É—à–∏ –∏–ª–∏ —Å—Ä–∞–∑—É —É–ª—å—Ç—Ä–∞–º–∞—Ä–∞—Ñ–æ–Ω ‚Äî —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞ —á—Ç–æ —Å–ø–æ—Å–æ–±–µ–Ω? –†–∞—Å—Å–∫–∞–∂–∏, –∫–∞–∫–æ–π —É —Ç–µ–±—è —É—Ä–æ–≤–µ–Ω—å: ¬´–µ—â—ë –¥—ã—à—É¬ª, ¬´—É–∂–µ –ø–æ—Ç–µ—é¬ª –∏–ª–∏ ¬´—è ‚Äî –º–∞—à–∏–Ω–∞¬ª?",
    "–ü—Ä–∏–≤–µ—Ç, –Ω–æ–≤–∏—á–æ–∫! –í –Ω–∞—à–µ–º —á–∞—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ—Å—Ç—ã–µ: –µ—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –±–µ–∂–∞—Ç—å ‚Äî –∏–¥–∏, –µ—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –∏–¥—Ç–∏ ‚Äî –ø–æ–ª–∑–∏, –Ω–æ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ —Å–¥–∞–≤–∞–π—Å—è! –¢–∞–∫ —Ç—ã –∫—Ç–æ: –Ω–∞—á–∏–Ω–∞—é—â–∏–π —Å—Ç–∞–π–µ—Ä, –æ–ø—ã—Ç–Ω—ã–π –º–∞—Ä–∞—Ñ–æ–Ω–µ—Ü –∏–ª–∏ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Ä–µ–∫–æ—Ä–¥—Å–º–µ–Ω –≤ –æ–∂–∏–¥–∞–Ω–∏–∏?",
    "–û–≥–æ, –Ω–æ–≤—ã–π –±–µ–≥—É–Ω –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ! –°—Ä–æ—á–Ω–æ –∑–∞–ø–æ–ª–Ω–∏ –∞–Ω–∫–µ—Ç—É: –∏–º—è, –ª—é–±–∏–º—ã–π –º–∞—Ä—à—Ä—É—Ç –∏ —Ü–µ–ª—å –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π –∑–∞–±–µ–≥ (–æ—Ç ¬´–ø—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å¬ª –¥–æ ¬´–ø–æ—Ä–≤–∞—Ç—å –≤—Å–µ—Ö –Ω–∞ —Ñ–∏–Ω–∏—à–µ¬ª). –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥—É!",
    "–ü—Ä–∏–≤–µ—Ç! –¢—ã –ø–æ–ø–∞–ª –≤ –º–µ—Å—Ç–æ, –≥–¥–µ –∫–∏–ª–æ–º–µ—Ç—Ä—ã —Å—á–∏—Ç–∞—é—Ç –Ω–µ –ø–æ GPS, –∞ –ø–æ —É–ª—ã–±–∫–∞–º. –¢–∞–∫ —á—Ç–æ —Ç—ã: —Ç–æ—Ç, –∫—Ç–æ —Ç–æ–ª—å–∫–æ —É—á–∏—Ç—Å—è –∑–∞–≤—è–∑—ã–≤–∞—Ç—å –∫—Ä–æ—Å—Å–æ–≤–∫–∏, —É–∂–µ –±–µ–≥–∞–µ—Ç –ø–æ —É—Ç—Ä–∞–º –∏–ª–∏ –≥–æ—Ç–æ–≤ –ø—Ä–æ–±–µ–∂–∞—Ç—å –º–∞—Ä–∞—Ñ–æ–Ω –≤ –ø–∏–∂–∞–º–µ?",
    "–í–Ω–∏–º–∞–Ω–∏–µ! –í —á–∞—Ç–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Å–≤–µ–∂–∏–π –±–µ–≥–æ–≤–æ–π —Ä–µ—Å—É—Ä—Å! –û–±—ä–µ–∫—Ç, –Ω–∞–∑–æ–≤–∏—Ç–µ –≤–∞—à —Å—Ç–∞—Ç—É—Å: ¬´–µ—â—ë –Ω–µ –ø—Ä–æ–±–µ–∂–∞–ª –ø–µ—Ä–≤—ã–π –∫–º¬ª, ¬´—É–∂–µ –≤—Ç—è–Ω—É–ª—Å—è¬ª –∏–ª–∏ ¬´—è —Ç—É—Ç –≥–ª–∞–≤–Ω—ã–π –ø–µ–π—Å–º–µ–π–∫–µ—Ä¬ª?",
    "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–µ–≥–æ–≤—É—é —Å–µ–º—å—é! –£ –Ω–∞—Å —Ç—É—Ç —Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –Ω–æ–≤–∏—á–∫–∏ (–∫–æ—Ç–æ—Ä—ã–µ –±–æ—è—Ç—Å—è —Å–ª–æ–≤–∞ ¬´–º–∞—Ä–∞—Ñ–æ–Ω¬ª), –ª—é–±–∏—Ç–µ–ª–∏ (–∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –∑–Ω–∞—é—Ç, —á—Ç–æ —Ç–∞–∫–æ–µ –∫—Ä–µ–ø–∞—Ç—É—Ä–∞) –∏ –ª–µ–≥–µ–Ω–¥—ã (–∫–æ—Ç–æ—Ä—ã–µ –±–µ–≥–∞—é—Ç –¥–∞–∂–µ –≤–æ —Å–Ω–µ). –ö –∫–∞–∫–æ–π –æ—Ç–Ω–æ—Å–∏—à—å—Å—è —Ç—ã?",
    "–≠–π, –Ω–æ–≤–µ–Ω—å–∫–∏–π! –ü—Ä–∏–∑–Ω–∞–≤–∞–π—Å—è: —Ç—ã —Ç—É—Ç —á—Ç–æ–±—ã —Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∫–æ—Ä–¥—ã, –∏—Å–∫–∞—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–±–æ–ª—Ç–∞—Ç—å –æ –∫—Ä–æ—Å—Å–æ–≤–∫–∞—Ö? –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ ‚Äî –±–µ–≥–∏ –∫ –Ω–∞–º, —É –Ω–∞—Å –≤–µ—Å–µ–ª–æ!",
    "–ü—Ä–∏–≤–µ—Ç-–ø—Ä–∏–≤–µ—Ç! –¢—ã —Å–µ–π—á–∞—Å –Ω–∞ —ç—Ç–∞–ø–µ: ¬´–∫—Ç–æ –≤—Å–µ —ç—Ç–∏ –±–µ–≥—É–Ω—ã?¬ª, ¬´–æ, —Ç—É—Ç –∫–ª–∞—Å—Å–Ω—ã–µ —Ä–µ–±—è—Ç–∞¬ª –∏–ª–∏ ¬´—è –∑–Ω–∞—é –≤—Å–µ —Ç—Ä–∞—Å—Å—ã, –Ω–æ –Ω–∏–∫–æ–º—É –Ω–µ —Å–∫–∞–∂—É¬ª? –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –∑–∞–±–µ–≥!",
    "–ù–æ–≤—ã–π —É—á–∞—Å—Ç–Ω–∏–∫? –û—Ç–ª–∏—á–Ω–æ! –£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –ª—ë–≥–∫–∏–π (–ø—Ä–æ—Å—Ç–æ –≤—ã–π—Ç–∏ –Ω–∞ –ø—Ä–æ–±–µ–∂–∫—É), —Å—Ä–µ–¥–Ω–∏–π (–Ω–µ —Å–æ–π—Ç–∏ —Å –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏) –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π (—É–ª—ã–±–∞—Ç—å—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö). –ö–∞–∫–æ–π –≤—ã–±–∏—Ä–∞–µ—à—å?",
    "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —á–∞—Ç, –≥–¥–µ –∫–∏–ª–æ–º–µ—Ç—Ä—ã ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ü–∏—Ñ—Ä—ã, –∞ –∏—Å—Ç–æ—Ä–∏–∏! –¢—ã –∫—Ç–æ: —Ç–æ—Ç, –∫—Ç–æ —Ç–æ–ª—å–∫–æ –º–µ—á—Ç–∞–µ—Ç –æ –ø–µ—Ä–≤–æ–º –∑–∞–±–µ–≥–µ, —É–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ–¥–∞–ª–∏ –∏–ª–∏ –≥–æ—Ç–æ–≤ –ø—Ä–æ–±–µ–∂–∞—Ç—å 42 –∫–º —Ä–∞–¥–∏ —à—É—Ç–∫–∏?",
]

MOTIVATION_QUOTES = [
    "üèÉ –°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã —Å—Ç–∞—Ç—å –ª—É—á—à–µ!",
    "üí™ –ö–∞–∂–¥—ã–π –∫–º ‚Äî —ç—Ç–æ –ø–æ–±–µ–¥–∞ –Ω–∞–¥ —Å–æ–±–æ–π!",
    "üöÄ –ù–µ –∂–¥–∏ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞. –°–æ–∑–¥–∞–π –µ–≥–æ —Å–≤–æ–∏–º –±–µ–≥–æ–º!",
    "üî• –¢–≤–æ–π –¥–∏–≤–∞–Ω —Å–∫—É—á–∞–µ—Ç, –∞ –±–µ–≥ –∂–¥—ë—Ç —Ç–µ–±—è!",
    "‚≠ê –°–µ–≥–æ–¥–Ω—è —Ç—ã –±–µ–∂–∏—à—å –∑–∞–≤—Ç—Ä–∞—à–Ω—é—é –≤–µ—Ä—Å–∏—é —Å–µ–±—è!",
    "üí® –ë–æ–ª—å—à–µ –±–µ–≥–∞ ‚Äî –º–µ–Ω—å—à–µ —Å—Ç—Ä–µ—Å—Å–∞!",
    "üéØ –ü—Ä–æ–±–µ–∂–∫–∞ —Å–µ–≥–æ–¥–Ω—è = —É–ª—ã–±–∫–∞ –∑–∞–≤—Ç—Ä–∞!",
    "üèÖ –ì–ª–∞–≤–Ω—ã–π –∑–∞–±–µ–≥ ‚Äî —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –Ω–∞—á–∞–ª!",
    "üåü –õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –±–µ–≥–∞ ‚Äî —Å–µ–π—á–∞—Å!",
    "üí• –¢—ã —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –¥—É–º–∞–µ—à—å!",
    "‚ö° –ö–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç —Ç–µ–±—è –∫ —Ü–µ–ª–∏!",
    "üåà –ü–æ—Å–ª–µ –ø—Ä–æ–±–µ–∂–∫–∏ –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ!",
    "üî• –î–∏–≤–∞–Ω ‚Äî —ç—Ç–æ –Ω–µ —Ç–≤–æ–π –¥–æ–º. –î–æ—Ä–æ–≥–∞ ‚Äî —Ç–≤–æ–π –¥—Ä—É–≥!",
    "üí™ –í—á–µ—Ä–∞ —Ç—ã –Ω–µ —Å–º–æ–≥. –°–µ–≥–æ–¥–Ω—è —Ç—ã –±–µ–∂–∏—à—å!",
    "‚≠ê –ë–µ–≥ ‚Äî —ç—Ç–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–∫—É–ø–∞—Ç—å!",
    "üéì –ë–µ–≥ —É—á–∏—Ç –Ω–∞—Å, —á—Ç–æ —Ñ–∏–Ω–∏—à –≤—Å–µ–≥–¥–∞ –±–ª–∏–∂–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è!",
    "üèÜ –°–µ–≥–æ–¥–Ω—è—à–Ω—è—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî —ç—Ç–æ –∑–∞–≤—Ç—Ä–∞—à–Ω—è—è –ø–æ–±–µ–¥–∞!",
    "üåÖ –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–±–µ–∂–∫–∞ –¥–∞—ë—Ç —Å–∏–ª –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å!",
    "üíÜ –ë–µ–≥ ‚Äî –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ–ª–æ–≤—É!",
    "üîÑ –ö–∞–∂–¥—ã–π –∫—Ä—É–≥ ‚Äî —ç—Ç–æ —à–∞–Ω—Å —Å—Ç–∞—Ç—å –ª—É—á—à–µ!",
    "ü§ù –ë–µ–≥ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–∏–ª—å–Ω—ã—Ö –¥—É—Ö–æ–º!",
    "üé™ –ñ–∏–∑–Ω—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞, —á—Ç–æ–±—ã –Ω–µ –±–µ–≥–∞—Ç—å!",
    "üßò‚Äç‚ôÄÔ∏è –ë–µ–≥ ‚Äî —ç—Ç–æ –º–µ–¥–∏—Ç–∞—Ü–∏—è –≤ –¥–≤–∏–∂–µ–Ω–∏–∏!",
    "üöÄ –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å ‚Äî –∏ –ø–æ—Ç–µ—Ä—è–µ—à—å —Ç–µ–º–ø!",
    "üí´ –ë–µ–≥–∏ —Ç–∞–∫, –±—É–¥—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç!",
    "üèÉ‚Äç‚ôÇÔ∏è –ù–µ –±–µ–≥–∞–π –æ—Ç –ø—Ä–æ–±–ª–µ–º ‚Äî –±–µ–≥–∏ –∫ —Ü–µ–ª—è–º!",
    "‚≠ê –ö–∞–∂–¥—ã–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω –±—ã–ª –Ω–æ–≤–∏—á–∫–æ–º. –ù–∞—á–Ω–∏ —Å–µ–≥–æ–¥–Ω—è!",
    "üî• –°–ª–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 –∫–º. –î–∞–ª—å—à–µ ‚Äî –ª–µ–≥—á–µ!",
    "üí™ –¢–≤–æ–∏ –Ω–æ–≥–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –ø–æ–ª—ë—Ç–∞!",
    "üåü –ë–µ–≥ ‚Äî —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞. –≠—Ç–æ —Å–≤–æ–±–æ–¥–∞!",
    "üéØ –ü–æ—Å—Ç–∞–≤—å —Ü–µ–ª—å ‚Äî –∏ –±–µ–≥–∏ –∫ –Ω–µ–π!",
    "üí• –ë–æ–ª—å—à–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç ¬´—Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ¬ª –∏–ª–∏ ¬´—Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ¬ª!",
    "üèÉ‚Äç‚ôÄÔ∏è –ù–∞—á–Ω–∏ –±–µ–∂–∞—Ç—å ‚Äî –∏ —É–≤–∏–¥–∏—à—å, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—Å—è –∂–∏–∑–Ω—å!",
    "‚≠ê –î–∏–≤–∞–Ω –Ω–µ –¥–∞—Å—Ç —Ç–µ–±–µ –º–µ–¥–∞–ª—å. –ê –±–µ–≥ ‚Äî –¥–∞—Å—Ç!",
    "üî• –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä!",
    "üí™ –í–µ—Ä—å –≤ —Å–µ–±—è ‚Äî –∏ –±–µ–≥–∏!",
    "üåü –¢—ã –º–æ–∂–µ—à—å –±–æ–ª—å—à–µ, —á–µ–º –¥—É–º–∞–µ—à—å!",
]

# ============== –°–ú–ï–®–ù–´–ï –†–£–ì–ê–¢–ï–õ–¨–°–¢–í–ê ==============
FUNNY_INSULTS = [
    "–¢—ã –∫–∞–∫ –±—Ä–æ–∫–∫–æ–ª–∏ ‚Äî –Ω–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç, –∑–∞—á–µ–º —Ç—ã –Ω—É–∂–µ–Ω, –∏ –≤—Å–µ –¥–µ–ª–∞—é—Ç –≤–∏–¥, —á—Ç–æ —Ç–µ–±—è –Ω–µ—Ç.",
    "–ï—Å–ª–∏ –±—ã —Ç—É–ø–æ—Å—Ç—å –±—ã–ª–∞ –æ–ª–∏–º–ø–∏–π—Å–∫–∏–º –≤–∏–¥–æ–º —Å–ø–æ—Ä—Ç–∞, —Ç—ã –±—ã —É–∂–µ –≤—ã–∏–≥—Ä–∞–ª –∑–æ–ª–æ—Ç–æ, —Å–µ—Ä–µ–±—Ä–æ –∏ –±—Ä–æ–Ω–∑—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.",
    "–¢—ã –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, —É –∫–æ—Ç–æ—Ä–æ–≥–æ Wi-Fi —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Ç–≤–æ–∏ –º–æ–∑–≥–∏.",
    "–¢–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ wi-fi –≤ –º–µ—Ç—Ä–æ ‚Äî –µ—Å—Ç—å, –Ω–æ —Ç–æ–ª–∫—É –Ω–æ–ª—å.",
    "–¢—ã –¥—É–º–∞–µ—à—å, —á—Ç–æ —Ç–≤–æ—ë –º–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω–æ? –≠—Ç–æ –º–∏–ª–æ. –ü—Ä–∞–≤–¥–∞, –º–∏–ª–æ.",
    "–Ø –±—ã –Ω–∞–∑–≤–∞–ª —Ç–µ–±—è –∏–¥–∏–æ—Ç–æ–º, –Ω–æ —Ç–æ–≥–¥–∞ –±—ã —è —Å–æ–≤—Ä–∞–ª, –∞ —è —Å–µ–±–µ —Ç–∞–∫–æ–≥–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é.",
    "–¢—ã –∫–∞–∫ –π–æ–≥—É—Ä—Ç —Å –∏—Å—Ç—ë–∫—à–∏–º —Å—Ä–æ–∫–æ–º ‚Äî –ª–µ–∂–∞–ª-–ª–µ–∂–∞–ª, –∞ –ø–æ—Ç–æ–º –≤—ã–±—Ä–æ—Å–∏–ª–∏.",
    "–ï—Å–ª–∏ –±—ã –Ω–µ—É–¥–∞—á–∏ –±—ã–ª–∏ –∫–æ–Ω–∫—É—Ä—Å–æ–º –∫—Ä–∞—Å–æ—Ç—ã, —Ç—ã –±—ã –∫–æ—Ä–æ–ª–µ–≤–∞ –±–∞–ª–∞.",
    "–¢–≤–æ—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∂–∏–∑–Ω–∏: ¬´–ê–≤–æ—Å—å –ø—Ä–æ–Ω–µ—Å—ë—Ç¬ª. –ò –≤–µ–¥—å –Ω–µ –ø—Ä–æ–Ω–µ—Å–ª–æ.",
    "–¢—ã –∫–∞–∫ –±—É–º–µ—Ä–∞–Ω–≥ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è, –Ω–æ –Ω–∏–∫—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ —Ö–æ—á–µ—Ç.",
    "–î—É–º–∞–µ—à—å, —Ç—ã –≤–∞–∂–µ–Ω? –°–≤–µ—á–∫–∞ –≤ —Ç–æ—Ä—Ç–µ —Ç–æ–∂–µ –¥—É–º–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ –≥–ª–∞–≤–Ω–∞—è, –ø–æ–∫–∞ –µ—ë –Ω–µ –∑–∞–¥—É–ª–∏.",
    "–¢—ã –∫–∞–∫ –ø–∞–∑–ª ‚Äî 1000 –¥–µ—Ç–∞–ª–µ–π, –Ω–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è.",
    "–¢–≤–æ—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–µ–±–µ –≤–æ—Å—Ö–∏—â–∞–µ—Ç. –ò –ø—É–≥–∞–µ—Ç. –í –æ—Å–Ω–æ–≤–Ω–æ–º –ø—É–≥–∞–µ—Ç.",
    "–ï—Å–ª–∏ –±—ã –≥–ª—É–ø–æ—Å—Ç—å –±—ã–ª–∞ –±–æ–ª—å—é, —Ç—ã –±—ã –æ—Ä–∞–ª –Ω–∞ –≤–µ—Å—å –º–∏—Ä.",
    "–¢—ã –∫–∞–∫ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä ‚Äî –ø–æ–∫–∞ –∑–∞—Ä—è–∂–∞–µ—à—å, —É–∂–µ —Ä–∞–∑—Ä—è–¥–∏–ª—Å—è.",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å—ë –ø–æ—Ä—Ç–∏—Ç—å –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã.",
    "–¢—ã –∫–∞–∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Äî —Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–æ –Ω–µ—Ç, –∞ —Ç–æ–ª–∫—É –æ—Ç —Ç–µ–±—è –∫–∞–∫ –æ—Ç —Å–æ–ª—ë–Ω–æ–≥–æ –æ–≥—É—Ä—Ü–∞ –≤ —à–æ–∫–æ–ª–∞–¥–µ.",
    "–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Ç—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å —Ä–æ—Ç, —è –ø–æ–Ω–∏–º–∞—é, –ø–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª—é–¥–∏ –≤—ã–±–∏—Ä–∞—é—Ç –º–æ–ª—á–∞–Ω–∏–µ.",
    "–¢—ã –∫–∞–∫ –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –≤—Å–µ —Ç–µ–±—è —Ç–µ—Ä–ø—è—Ç, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç —Å —Ç–æ–±–æ–π –æ–±—â–∞—Ç—å—Å—è.",
    "–¢–≤–æ—è –ª–æ–≥–∏–∫–∞ —Å–ª–æ–º–∞–Ω–∞ —Å–∏–ª—å–Ω–µ–µ, —á–µ–º —ç–∫—Ä–∞–Ω —É –±–∞–±—É—à–∫–∏–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
    "–¢—ã –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —É–º—É–¥—Ä—è–µ—Ç—Å—è —É–ø–∞—Å—Ç—å –Ω–∞ —Ä–æ–≤–Ω–æ–º –º–µ—Å—Ç–µ, –Ω–æ –≤ –ª—É–∂—É –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç.",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è –≥–ª—É–ø–æ—Å—Ç—å –±—ã–ª–∞ —ç–Ω–µ—Ä–≥–∏–µ–π, –º—ã –±—ã –∑–∞–±—ã–ª–∏ –ø—Ä–æ –Ω–µ—Ñ—Ç—å –∏ –≥–∞–∑.",
    "–¢—ã –∫–∞–∫ —á–∞–π–Ω—ã–π –ø–∞–∫–µ—Ç–∏–∫ ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤ –≥–æ—Ä—è—á—É—é –≤–æ–¥—É, –∞ –ø–æ—Ç–æ–º –≤—ã–±—Ä–æ—Å–∏–ª–∏.",
    "–¢–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è —Ö—É–∂–µ, —á–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –≤ –≥–æ—Ä–∞—Ö ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ.",
    "–¢—ã –∫–∞–∫ –ª–∏–º–æ–Ω ‚Äî –∫–∏—Å–ª—ã–π, –º–æ—Ä—â–∏–Ω–∏—Å—Ç—ã–π –∏ –æ—Ç —Ç–µ–±—è –≤—Å–µ –º–æ—Ä—â–∞—Ç—Å—è.",
    "–ï—Å–ª–∏ –±—ã –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –±—ã–ª–∞ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º –∂–∞–Ω—Ä–æ–º, —Ç—ã –±—ã –Ω–µ –ø–æ–ø–∞–ª –≤ –ø–ª–µ–π–ª–∏—Å—Ç.",
    "–¢—ã –∫–∞–∫ –±–∞—Ç–∞—Ä–µ–π–∫–∞ ‚Äî —Å–µ–ª –≤ —Å–∞–º—ã–π –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–æ–º–µ–Ω—Ç.",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å—ë —É—Å–ª–æ–∂–Ω—è—Ç—å –¥–æ—Å—Ç–æ–π–Ω–∞ –ù–æ–±–µ–ª–µ–≤—Å–∫–æ–π –ø—Ä–µ–º–∏–∏ –ø–æ –∏–¥–∏–æ—Ç–∏–∑–º—É.",
    "–¢—ã –∫–∞–∫ –ø–ª–æ—Ö–æ–π –∞–Ω–µ–∫–¥–æ—Ç ‚Äî –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–µ—ë—Ç—Å—è, –∞ —Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞–µ—à—å —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å.",
    "–¢–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ –±—É—Ç–µ—Ä–±—Ä–æ–¥ ‚Äî –ø–∞–¥–∞–µ—Ç –º–∞—Å–ª–æ–º –≤–Ω–∏–∑, –≤—Å–µ–≥–¥–∞.",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è –∂–∏–∑–Ω—å –±—ã–ª–∞ —Ñ–∏–ª—å–º–æ–º, —ç—Ç–æ –±—ã–ª –±—ã —Ç—Ä–∏–ª–ª–µ—Ä —Å –ø–ª–æ—Ö–∏–º –∫–æ–Ω—Ü–æ–º.",
    "–¢—ã –∫–∞–∫ —Å—Ç–∞—Ä—ã–π —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ ‚Äî —à—É–º–∏—Ç, –Ω–æ –Ω–∏—á–µ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç.",
    "–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞ —É–º–µ—Ä–ª–æ –∏ –ø–æ—Ö–æ—Ä–æ–Ω–µ–Ω–æ –≥–ª—É–±–æ–∫–æ –≤ –±—É–Ω–∫–µ—Ä–µ.",
    "–¢—ã –∫–∞–∫ —à–∞—É—Ä–º–∞ –≤ —Ç—Ä–∏ —á–∞—Å–∞ –Ω–æ—á–∏ ‚Äî –≤—Ä–æ–¥–µ —Ö–æ—á–µ—Ç—Å—è, –Ω–æ –ø–æ—Ç–æ–º –∂–∞–ª–µ–µ—à—å.",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞ –±—ã–ª–∞ —Ä–∞–∑–º–µ—Ä–æ–º, –æ–Ω–∞ –±—ã –ø–æ–º–µ—Å—Ç–∏–ª–∞—Å—å –≤ –Ω–∞–ø–µ—Ä—Å—Ç–æ–∫.",
    "–¢—ã –∫–∞–∫ –¥–≤–µ—Ä—å –≤ –ø—É–±–ª–∏—á–Ω–æ–º —Ç—É–∞–ª–µ—Ç–µ ‚Äî —Ç–æ–ª–∫–Ω–µ—à—å, –∞ —Ç–∞–º —Ç–∞–∫–æ–µ...",
    "–¢–≤–æ–∏ –º–æ–∑–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫ –º–µ–¥–ª–µ–Ω–Ω–æ, —á—Ç–æ —è –º–æ–≥ –±—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—ã—Å—Ç—Ä–µ–µ.",
    "–¢—ã –∫–∞–∫ –º–µ–º —Å –∫–æ—Ç–∏–∫–æ–º ‚Äî –≤—Å–µ —Å–º–æ—Ç—Ä—è—Ç, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç, –ø–æ—á–µ–º—É —ç—Ç–æ —Å–º–µ—à–Ω–æ.",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, —Ç–µ–±—è –±—ã —É–¥–∞–ª–∏–ª–∏ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.",
    "–¢—ã –∫–∞–∫ –∑–æ–Ω—Ç–∏–∫ –≤ –ª–∏–≤–µ–Ω—å ‚Äî –ª–æ–º–∞–µ—Ç—Å—è –≤ —Å–∞–º—ã–π –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç.",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å—ë –ø–æ—Ä—Ç–∏—Ç—å ‚Äî —ç—Ç–æ —Ç–∞–ª–∞–Ω—Ç. –ó–ª–æ–π —Ç–∞–ª–∞–Ω—Ç.",
    "–¢—ã –∫–∞–∫ —à–Ω—É—Ä–∫–∏ ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–∑–≤—è–∑—ã–≤–∞–µ—à—å—Å—è –≤ —Å–∞–º—ã–π –Ω–µ—É–¥–æ–±–Ω—ã–π –º–æ–º–µ–Ω—Ç.",
    "–ï—Å–ª–∏ –±—ã –≥–ª—É–ø–æ—Å—Ç—å –±—ã–ª–∞ –∏—Å–∫—É—Å—Å—Ç–≤–æ–º, —Ç—ã –±—ã –ü–∏–∫–∞—Å—Å–æ. –ù–æ —ç—Ç–æ –Ω–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ.",
    "–¢—ã –∫–∞–∫ –±—É–º–∞–∂–∫–∞ ‚Äî –º–Ω—ë—Ç—Å—è –æ—Ç –ª—é–±–æ–≥–æ –¥—É–Ω–æ–≤–µ–Ω–∏—è, –∞ —Ç–æ–ª–∫—É –Ω–æ–ª—å.",
    "–¢–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ —ç–∫—Ä–∞–Ω —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞ ‚Äî —á—ë—Ä–Ω—ã–π –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç.",
    "–¢—ã –∫–∞–∫ —Å–æ–ª–Ω—Ü–µ ‚Äî –≤—Å–µ –∑–Ω–∞—é—Ç, —á—Ç–æ —Ç—ã –µ—Å—Ç—å, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç –∫ —Ç–µ–±–µ.",
    "–ï—Å–ª–∏ –±—ã –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –±—ã–ª–∞ –æ–ø—Ü–∏–µ–π, —Ç—ã –±—ã –≤—ã–±—Ä–∞–ª ¬´–≤—ã–∫–ª—é—á–µ–Ω–æ¬ª.",
    "–¢—ã –∫–∞–∫ –º–µ–¥—É–∑–∞ ‚Äî –º–µ–¥–ª–µ–Ω–Ω—ã–π, –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π –∏ –∂–∂—ë—Ç—Å—è.",
    "–¢–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è —Ö—É–∂–µ, —á–µ–º –≥–æ—Ä–æ—Å–∫–æ–ø –≤ –¥–µ—à—ë–≤–æ–π –≥–∞–∑–µ—Ç–µ.",
    "–¢—ã –∫–∞–∫ –ª–æ–∂–∫–∞ ‚Äî –≤—Å–µ–≥–¥–∞ –æ–ø–∞–∑–¥—ã–≤–∞–µ—à—å, –∫–æ–≥–¥–∞ —Ç–µ–±—è –∏—â–µ—à—å.",
]

# ============== –°–ú–ï–®–ù–´–ï –ö–û–ú–ü–õ–ò–ú–ï–ù–¢–´ ==============
FUNNY_COMPLIMENTS = [
    "–¢—ã –∫–∞–∫ —Å–æ–ª–Ω—Ü–µ ‚Äî –¥–∞–∂–µ —á–µ—Ä–µ–∑ —Ç—É—á–∏ –ø—Ä–æ–±–∏–≤–∞–µ—à—å—Å—è –∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –≤—Å–µ—Ö —É–ª—ã–±–∞—Ç—å—Å—è!",
    "–¢–≤–æ—è —É–ª—ã–±–∫–∞ —è—Ä—á–µ, —á–µ–º –º–æ–π —ç–∫—Ä–∞–Ω –≤ —Ç—Ä–∏ —á–∞—Å–∞ –Ω–æ—á–∏. –°–µ—Ä—å—ë–∑–Ω–æ, —Ç—ã —Å–≤–µ—Ç–∏—à—å!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, —è –±—ã –ø–æ—Å—Ç–∞–≤–∏–ª 5 –∑–≤—ë–∑–¥ –∏ –Ω–∞–ø–∏—Å–∞–ª –≤–æ—Å—Ç–æ—Ä–∂–µ–Ω–Ω—ã–π –æ—Ç–∑—ã–≤!",
    "–¢—ã –∫–∞–∫ Wi-Fi ‚Äî –±–µ–∑ —Ç–µ–±—è –∂–∏–∑–Ω—å –±—ã–ª–∞ –±—ã –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ –∏ –ø–æ–ª–Ω–∞ –≥—Ä—É—Å—Ç–∏.",
    "–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–∞–º—è—Ç–Ω–∏–∫–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞!",
    "–¢—ã –∫–∞–∫ –≥–æ—Ä—è—á–∏–π —à–æ–∫–æ–ª–∞–¥ –∑–∏–º–æ–π ‚Äî —Å–æ–≥—Ä–µ–≤–∞–µ—à—å, —Ä–∞–¥—É–µ—à—å –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –Ω–∞–¥–æ–µ–¥–∞–µ—à—å!",
    "–ï—Å–ª–∏ –±—ã –≤—Å–µ –ª—é–¥–∏ –±—ã–ª–∏ –∫–∞–∫ —Ç—ã, –≤ –º–∏—Ä–µ –±—ã –Ω–µ –±—ã–ª–æ –≤–æ–π–Ω, —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ü–µ—Ä—Ç—ã –∏ –≤–µ—á–µ—Ä–∏–Ω–∫–∏!",
    "–¢—ã –∫–∞–∫ –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç ‚Äî –∫–∞–∂–¥–∞—è –ø–µ—Å–Ω—è –≤ —Ç–µ–º—É, –∏ —Ö–æ—á–µ—Ç—Å—è —Å–ª—É—à–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ!",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ–¥–Ω–∏–º–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –ù–æ–±–µ–ª–µ–≤—Å–∫–æ–π –ø—Ä–µ–º–∏–∏ –ø–æ —Ä–∞–¥–æ—Å—Ç–∏!",
    "–¢—ã –∫–∞–∫ –∫–æ—Ç –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ ‚Äî –º–∏–ª—ã–π, —Å–ø–æ–∫–æ–π–Ω—ã–π –∏ –¥–µ–ª–∞–µ—à—å –¥–µ–Ω—å –ª—É—á—à–µ –æ–¥–Ω–∏–º —Å–≤–æ–∏–º –≤–∏–¥–æ–º!",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è –¥–æ–±—Ä–æ—Ç–∞ –±—ã–ª–∞ —ç–Ω–µ—Ä–≥–∏–µ–π, –º—ã –±—ã –∑–∞–±—ã–ª–∏ –ø—Ä–æ –≤—Å–µ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã!",
    "–¢—ã –∫–∞–∫ —Å–≤–µ–∂–µ–µ –ø–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å—ë ‚Äî –ø–æ—Å–ª–µ –æ–±—â–µ–Ω–∏—è —Å —Ç–æ–±–æ–π —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º!",
    "–¢–≤–æ—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, —á–µ–º –º–æ–π –±—É–¥–∏–ª—å–Ω–∏–∫ ‚Äî –≤—Å–µ–≥–¥–∞ –≤–æ–≤—Ä–µ–º—è –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–¥–≤–æ–¥–∏—Ç!",
    "–¢—ã –∫–∞–∫ –ª—É—á—à–∞—è –ø–µ—Å–Ω—è –≤ –º–æ–µ–π –≥–æ–ª–æ–≤–µ ‚Äî –∫—Ä—É—Ç–∏—à—å—Å—è –∏ –Ω–µ –¥–∞—ë—à—å –º–Ω–µ –≥—Ä—É—Å—Ç–∏—Ç—å!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª —Å–ø–µ—Ü–∏–µ–π, —Ç—ã –±—ã–ª –±—ã –∫—É—Ä–∫—É–º–æ–π ‚Äî –ø–æ–ª–µ–∑–Ω—ã–π, —è—Ä–∫–∏–π –∏ –¥–µ–ª–∞–µ—à—å –≤—Å—ë –ª—É—á—à–µ!",
    "–¢—ã –∫–∞–∫ –ø—É—à–∏—Å—Ç—ã–π –ø–ª–µ–¥ –∑–∏–º–æ–π ‚Äî —É—é—Ç–Ω—ã–π, —Ç—ë–ø–ª—ã–π –∏ –æ—Ç —Ç–µ–±—è –Ω–µ —Ö–æ—á–µ—Ç—Å—è –æ—Ç—Ö–æ–¥–∏—Ç—å!",
    "–¢–≤–æ—ë —Ç–µ—Ä–ø–µ–Ω–∏–µ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ–ª–∏–º–ø–∏–π—Å–∫–æ–≥–æ –∑–æ–ª–æ—Ç–∞ –ø–æ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—é!",
    "–¢—ã –∫–∞–∫ –∑–æ–Ω—Ç–∏–∫ –≤ —Å–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å ‚Äî –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ, –Ω–æ –ø—Ä–∏—è—Ç–Ω–æ, –∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!",
    "–ï—Å–ª–∏ –±—ã —è –ø–∏—Å–∞–ª –∫–Ω–∏–≥—É –æ –∫—Ä—É—Ç—ã—Ö –ª—é–¥—è—Ö, —Ç—ã –±—ã–ª –±—ã –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ!",
    "–¢—ã –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ—Ñ–µ ‚Äî –±–æ–¥—Ä–∏—à—å, —Ä–∞–¥—É–µ—à—å –∏ –¥–µ–ª–∞–µ—à—å —É—Ç—Ä–æ –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–º!",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—å –≤—ã—Ö–æ–¥ —Ç–∞–º, –≥–¥–µ —è –≤–∏–∂—É —Å—Ç–µ–Ω—É, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –º–µ–Ω—è!",
    "–¢—ã –∫–∞–∫ –º–µ–º —Å –∫–æ—Ç–∏–∫–æ–º ‚Äî –≤—Å–µ —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ —Ç–µ–±—è –∏ —É–ª—ã–±–∞—é—Ç—Å—è, –Ω–µ –ø–æ–Ω–∏–º–∞—è –ø–æ—á–µ–º—É!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, —Ç—ã –±—ã–ª –±—ã –º–æ–∏–º –ª—é–±–∏–º—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º —Å –∏–¥–µ–∞–ª—å–Ω—ã–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º!",
    "–¢—ã –∫–∞–∫ –∞—Ä–æ–º–∞—Ç —Å–≤–µ–∂–µ–π –≤—ã–ø–µ—á–∫–∏ ‚Äî –ø—Ä–æ—Ö–æ–¥–∏—à—å –º–∏–º–æ –∏ —Å—Ä–∞–∑—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ—Ä–æ—à–æ!",
    "–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ —Å—Ç–∏–ª—è –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –Ω–∞ YouTube —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤!",
    "–¢—ã –∫–∞–∫ –∫–æ–º–ø–∞—Å –≤ –ª–µ—Å—É ‚Äî –±–µ–∑ —Ç–µ–±—è —è –±—ã —Ç–æ—á–Ω–æ –∑–∞–±–ª—É–¥–∏–ª—Å—è –∏ –≥—Ä—É—Å—Ç–∏–ª!",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –±—ã–ª–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ–º, —Ç—ã –±—ã –∑–∞–ø–∏—Ç–∞–ª —Ü–µ–ª—ã–π –≥–æ—Ä–æ–¥!",
    "–¢—ã –∫–∞–∫ –∏–¥–µ–∞–ª—å–Ω–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫—Ä–∞—Å–∏–≤—ã–π –∏ —Ö–æ—á–µ—Ç—Å—è —Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—á–Ω–æ!",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–ª—É—à–∞—Ç—å –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—ç—Ç–∫—É ¬´–õ—É—á—à–∏–π —Å–ª—É—à–∞—Ç–µ–ª—å –≥–æ–¥–∞¬ª!",
    "–¢—ã –∫–∞–∫ —Ç—ë–ø–ª–∞—è –≤–∞–Ω–Ω–∞ –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ–≥–æ –¥–Ω—è ‚Äî —Ä–∞—Å—Å–ª–∞–±–ª—è–µ—à—å, —É—Å–ø–æ–∫–∞–∏–≤–∞–µ—à—å –∏ –ª–µ—á–∏—à—å!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª —Ü–≤–µ—Ç–∫–æ–º, —Ç—ã –±—ã–ª –±—ã –ø–æ–¥—Å–æ–ª–Ω—É—Ö–æ–º ‚Äî –≤—Å–µ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ —Å–≤–µ—Ç –∏ –¥–∞—Ä–∏—à—å —Ä–∞–¥–æ—Å—Ç—å!",
    "–¢—ã –∫–∞–∫ –ª—É—á—à–∏–π –º–æ–º–µ–Ω—Ç –≤ —Ñ–∏–ª—å–º–µ ‚Äî —Ö–æ—á–µ—Ç—Å—è, —á—Ç–æ–±—ã –æ–Ω –¥–ª–∏–ª—Å—è –≤–µ—á–Ω–æ!",
    "–¢–≤–æ—ë –æ–±–∞—è–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, —á–µ–º –º–æ–π –ø–∞—Ä–æ–ª—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ ‚Äî –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É—Å—Ç–æ—è—Ç—å!",
    "–¢—ã –∫–∞–∫ –≤–æ–ª—à–µ–±–Ω–∞—è —Ç–∞–±–ª–µ—Ç–∫–∞ –æ—Ç –≥—Ä—É—Å—Ç–∏ ‚Äî –æ–¥–Ω–∞ —Ç–≤–æ—è —É–ª—ã–±–∫–∞ ‚Äî –∏ –≤—Å—ë —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ—Ä–æ—à–æ!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –∫–Ω–∏–≥–æ–π, —è –±—ã –ø—Ä–æ—á–∏—Ç–∞–ª —Ç–µ–±—è —Ç—ã—Å—è—á—É —Ä–∞–∑ –∏ –Ω–µ —É—Å—Ç–∞–ª!",
    "–¢—ã –∫–∞–∫ –ø–µ—Ä–≤–æ–µ —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ ‚Äî –Ω–µ–∂–Ω–æ–µ, —Ç—ë–ø–ª–æ–µ –∏ –æ–±–µ—â–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å!",
    "–¢–≤–æ—ë –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –∂–∏–∑–Ω–∏ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è!",
    "–¢—ã –∫–∞–∫ –ª—É—á—à–∏–π –¥—Ä—É–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Ç—ã –¥–∞–ª–µ–∫–æ!",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ–π –ø–æ–∑–∏—Ç–∏–≤ –±—ã–ª –≤–∏—Ä—É—Å–æ–º, —è –±—ã —Ö–æ—Ç–µ–ª –∑–∞—Ä–∞–∑–∏—Ç—å—Å—è –∏–º –Ω–∞–≤—Å–µ–≥–¥–∞!",
    "–¢—ã –∫–∞–∫ –∫–æ–Ω—Ü–µ—Ä—Ç –ª—é–±–∏–º–æ–π –≥—Ä—É–ø–ø—ã ‚Äî –≥—Ä–æ–º–∫–∏–π, —è—Ä–∫–∏–π –∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ —ç–º–æ—Ü–∏–∏!",
    "–¢–≤–æ—è –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Å–ª–µ–ø–ª—è–µ—Ç –º–µ–Ω—è –∫–∞–∫ —Ñ–æ–Ω–∞—Ä–∏–∫ –≤ —Ç–µ–º–Ω–æ—Ç–µ ‚Äî —è—Ä–∫–æ –∏ —Ä–∞–¥–æ—Å—Ç–Ω–æ!",
    "–¢—ã –∫–∞–∫ –¥–æ–º–∞—à–Ω–∏–π —É—é—Ç –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ–π –ø—Ä–æ–≥—É–ª–∫–∏ ‚Äî –∂–µ–ª–∞–Ω–Ω—ã–π, —Ç—ë–ø–ª—ã–π –∏ —É—Å–ø–æ–∫–∞–∏–≤–∞—é—â–∏–π!",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª —Å—É–ø–µ—Ä–≥–µ—Ä–æ–µ–º, —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞ –±—ã–ª–∞ –±—ã ‚Äî –¥–µ–ª–∞—Ç—å –≤—Å–µ—Ö —Å—á–∞—Å—Ç–ª–∏–≤—ã–º–∏!",
    "–¢—ã –∫–∞–∫ –∏–¥–µ–∞–ª—å–Ω—ã–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç –≤ —Ä–µ—Ü–µ–ø—Ç–µ ‚Äî –±–µ–∑ —Ç–µ–±—è –±–ª—é–¥–æ –±—ã–ª–æ –±—ã –Ω–µ–ø–æ–ª–Ω—ã–º!",
    "–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, —á–µ–º –º–æ–π –ª—é–±–∏–º—ã–π –ø–ª–µ–π–ª–∏—Å—Ç –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫!",
    "–¢—ã –∫–∞–∫ —Ä–∞—Å—Å–≤–µ—Ç –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ–π –Ω–æ—á–∏ ‚Äî –æ–±–µ—â–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ, —Å–≤–µ—Ç–ª–æ–≥–æ –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ!",
    "–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è –¥–æ–±—Ä–æ—Ç–∞ –±—ã–ª–∞ –º—É–∑—ã–∫–æ–π, –æ–Ω–∞ –∑–≤—É—á–∞–ª–∞ –±—ã –∫–∞–∫ —Å–∏–º—Ñ–æ–Ω–∏—è angels!",
    "–¢—ã –∫–∞–∫ —Ç–æ—Ä—Ç –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî —Å–ª–∞–¥–∫–∏–π, –∂–µ–ª–∞–Ω–Ω—ã–π –∏ –¥–µ–ª–∞–µ—Ç –¥–µ–Ω—å –æ—Å–æ–±–µ–Ω–Ω—ã–º!",
    "–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞ ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç –≤ –º–æ—ë–º –ª—é–±–∏–º–æ–º –±–ª—é–¥–µ!",
    "–¢—ã –∫–∞–∫ –ª—É—á—à–∏–π –º–æ–º–µ–Ω—Ç –¥–Ω—è ‚Äî —Ö–æ—á–µ—Ç—Å—è, —á—Ç–æ–±—ã –æ–Ω –ø–æ–≤—Ç–æ—Ä—è–ª—Å—è —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞!",
]

user_anon_state = {}

# ============== –ù–û–ß–ù–´–ï –°–û–û–ë–©–ï–ù–ò–Ø ==============
NIGHT_WARNINGS = [
    "üåô –•–≤–∞—Ç–∏—Ç –ø–∏—Å–∞—Ç—å, —Å–ø–∞—Ç—å –ø–æ—Ä–∞! –¢–µ–ª–µ–ø—É–∑–∏–∫–∏ —É–∂–µ —É—Å–Ω—É–ª–∏!",
    "üò¥ –ù–∞—Ä–æ–¥, 22:00! –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ ‚Äî –≤—Ä–∞–≥ —Å–Ω–∞!",
    "üõèÔ∏è –≠–π, –≤—ã —Ç–∞–º! –ó–∞–≤—Ç—Ä–∞ –±–µ–≥–∞—Ç—å, –∞ –≤—ã –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ!",
    "üí§ –ö—Ç–æ –Ω–µ —Å–ø–∏—Ç ‚Äî —Ç–æ—Ç –Ω–µ –±–µ–≥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ!",
    "üåÉ –ù–æ—á—å –Ω–∞ –¥–≤–æ—Ä–µ, –∞ –≤—ã –≤—Å—ë —á–∞—Ç–∏—Ç–µ—Å—å!",
    "üò± –í—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–≤—Ç—Ä–∞ –±–µ–≥–∞—Ç—å –∫–∞–∫ –∑–æ–º–±–∏?",
    "üé≠ –•–≤–∞—Ç–∏—Ç –∏–≥—Ä–∞—Ç—å –≤ –Ω–æ—á–Ω—ã—Ö –≥–µ—Ä–æ–µ–≤, –∏–¥–∏—Ç–µ —Å–ø–∞—Ç—å!",
    "üîÆ –í–æ–ª—à–µ–±—Å—Ç–≤–æ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –±–µ–≥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–µ–≥–æ —Å–Ω–∞!",
    "ü¶• –£—Ç—Ä–µ–Ω–Ω–∏–π –±–µ–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤–µ—á–Ω–æ–≥–æ —Å–Ω–∞!",
    "üåü –ó–≤—ë–∑–¥—ã —É–∂–µ –≤—ã—à–ª–∏, –∞ –≤—ã –µ—â—ë –≤ —á–∞—Ç–µ!",
]

# ============== –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø –í–û–ó–í–†–ê–©–ï–ù–¶–ï–í ==============
RETURN_GREETINGS = [
    "–û–æ–æ–æ, –∫–∞–∫–∏–µ –ª—é–¥–∏ –∏ –±–µ–∑ –æ—Ö—Ä–∞–Ω—ã! üï¥Ô∏è –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, –±–æ—Å—Å!",
    "üéâ –û–≥–æ, –∫—Ç–æ —ç—Ç–æ –≤–µ—Ä–Ω—É–ª—Å—è! –ú—ã —É–∂–µ –∑–∞–±—ã–ª–∏, –∫–∞–∫ —Ç—ã –≤—ã–≥–ª—è–¥–∏—à—å!",
    "üòÆ –£—Ö —Ç—ã! –õ–µ–≥–µ–Ω–¥–∞ –æ–±—ä—è–≤–∏–ª–∞—Å—å! –ì–¥–µ —Ç—ã –±—ã–ª —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏?",
    "üôå –°–º–æ—Ç—Ä–∏—Ç–µ-–∫–∞, –Ω–∞—à –≥–µ—Ä–æ–π —Å–Ω–æ–≤–∞ –≤ —Å—Ç—Ä–æ—é! –ü—Ä–æ–ø–∞–¥–∞–ª ‚Äî –Ω–µ–±–æ—Å—å, –º–∞—Ä–∞—Ñ–æ–Ω –±–µ–≥–∞–ª!",
    "üëÄ –ö—Ç–æ —ç—Ç–æ –ø–∏—à–µ—Ç? –ü—Ä–∏–∑—Ä–∞–∫ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º –≤ –º–∏—Ä –∂–∏–≤—ã—Ö!",
    "üöÄ –û–ø–∞-–Ω–∞! –ù–∞—à –∫–æ—Å–º–æ–Ω–∞–≤—Ç –ø—Ä–∏–∑–µ–º–ª–∏–ª—Å—è! –ö–∞–∫ —Ç–∞–º –≤ –æ—Ç–ø—É—Å–∫–µ –æ—Ç —á–∞—Ç–∞?",
    "üé© –ë–∞! –ë–∞! –ë–∞! –ö–∞–∫–∏–µ –≥–æ—Å—Ç–∏! –î–∞–≤–Ω–æ –Ω–µ –≤–∏–¥–µ–ª–∏—Å—å, –∞ —Ç—ã –≤—Å—ë –µ—â—ë –±–µ–≥–∞–µ—à—å?",
    "üòé –õ–µ–≥–µ–Ω–¥–∞ –≤ —á–∞—Ç–µ! –ú—ã —É–∂–µ —Ö–æ—Ç–µ–ª–∏ –≤–µ—à–∞—Ç—å —Ç–≤–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç –Ω–∞ —Å—Ç–µ–Ω—É!",
    "üèÜ –û, –≤–µ–ª–∏–∫–∏–π –≤–µ—Ä–Ω—É–ª—Å—è! –ë–µ–∑ —Ç–µ–±—è —á–∞—Ç —Å–æ–≤—Å–µ–º —Å–∫—É—á–∞–ª (–Ω–µ—Ç)!",
    "üåü –°–≤–µ—Ç –º–æ–π, –≤–µ—Ä–Ω—É–ª—Å—è! –ó–∞–∂–¥–∞–ª–∏—Å—å –º—ã —Ç–µ–±—è, –∞–∂ 2 –Ω–µ–¥–µ–ª–∏ –ø—Ä–æ—à–ª–æ!",
    "üé™ –¶–∏—Ä–∫ –≤ –≥–æ—Ä–æ–¥–µ! –ó–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å –ø–æ—á—Ç–∏–ª–∞ –Ω–∞—Å —Å–≤–æ–∏–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ–º!",
    "ü§¥ –ü—Ä–∏–Ω—Ü –≤–µ—Ä–Ω—É–ª—Å—è –≤ –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–æ! –¢—Ä–æ–Ω –∂–¥—ë—Ç, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!",
    "ü¶Å –¶–∞—Ä—å –ª–µ—Å–æ–≤ –æ–±—ä—è–≤–∏–ª—Å—è! –ü—Ä–æ–ø–∞–¥–∞–ª ‚Äî –æ—Ö–æ—Ç–∏–ª—Å—è –Ω–∞ –º–∞—Ä–∞—Ñ–æ–Ω—ã?",
    "üé∏ –†–æ–∫-–∑–≤–µ–∑–¥–∞ –≤ —á–∞—Ç–µ! –ì–¥–µ –±—ã–ª –Ω–∞ –≥–∞—Å—Ç—Ä–æ–ª—è—Ö, –≤ –±–µ–≥–µ –ø–æ –±–∞—Ä—Ö–∞–Ω–∞–º?",
    "üëë –ö–æ—Ä–æ–Ω–∞ —É–ø–∞–ª–∞! –ö–æ—Ä–æ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ —Ç—Ä–æ–Ω! –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!",
    "üßô –ú–∞–≥ –≤–µ—Ä–Ω—É–ª—Å—è –∏–∑ –∑–∞—Ç–æ—á–µ–Ω–∏—è! –ß–∞—Ä—ã —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç?",
    "ü¶∏ –°—É–ø–µ—Ä–≥–µ—Ä–æ–π —Å–ø–∞—Å –º–∏—Ä –∏ –≤–µ—Ä–Ω—É–ª—Å—è! –ö–∞–∫ —Ç–∞–º, –º–Ω–æ–≥–æ –∑–ª–∞ –ø–æ–±–µ–¥–∏–ª?",
    "üé≠ –ê–∫—Ç—ë—Ä –≤—ã—à–µ–ª –Ω–∞ —Å—Ü–µ–Ω—É! –î–∞–≤–Ω–æ –Ω–µ –±—ã–ª–∏ –≤ –≥–ª–∞–≤–Ω–æ–π —Ä–æ–ª–∏!",
    "üê≤ –î—Ä–∞–∫–æ–Ω –∏–∑ –ø–µ—â–µ—Ä—ã –≤—ã–ø–æ–ª–∑! –ì–¥–µ –ø—Ä—è—Ç–∞–ª—Å—è –æ—Ç –±–µ–≥–æ–≤—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫?",
    "ü¶Ö –û—Ä—ë–ª –ø—Ä–∏–ª–µ—Ç–µ–ª! –í—ã—Å–æ–∫–æ –ø–∞—Ä–∏–ª –Ω–∞–¥ –Ω–∞–º–∏ –≤—Å–µ —ç—Ç–∏ –¥–Ω–∏?",
]


# ============== –ü–û–ì–û–î–ê ==============
async def get_weather() -> str:
    try:
        async with httpx.AsyncClient() as client:
            moscow_response = await client.get(
                "https://api.open-meteo.com/v1/forecast",
                params={
                    "latitude": 55.7558,
                    "longitude": 37.6173,
                    "current_weather": "true",
                },
                timeout=10.0,
            )
            spb_response = await client.get(
                "https://api.open-meteo.com/v1/forecast",
                params={
                    "latitude": 59.9343,
                    "longitude": 30.3351,
                    "current_weather": "true",
                },
                timeout=10.0,
            )

            moscow_data = moscow_response.json()
            spb_data = spb_response.json()

            moscow_temp = moscow_data["current_weather"]["temperature"]
            moscow_wind = moscow_data["current_weather"]["windspeed"]
            spb_temp = spb_data["current_weather"]["temperature"]
            spb_wind = spb_data["current_weather"]["windspeed"]

            weather_text = (
                f"üå§ **–ü–æ–≥–æ–¥–∞ —É—Ç—Ä–æ–º:**\n"
                f"üèô –ú–æ—Å–∫–≤–∞: **{moscow_temp}¬∞C**, –≤–µ—Ç–µ—Ä {moscow_wind} –∫–º/—á\n"
                f"üåÜ –°–ü–±: **{spb_temp}¬∞C**, –≤–µ—Ç–µ—Ä {spb_wind} –∫–º/—á"
            )
            return weather_text
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã: {e}")
        return "üå§ –ü–æ–≥–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"


# ============== –£–¢–†–ï–ù–ù–ï–ï –ü–†–ò–í–ï–¢–°–¢–í–ò–ï ==============
def get_day_theme() -> str:
    now = datetime.now(MOSCOW_TZ)
    day_name_en = now.strftime("%A")
    return DAY_THEMES.get(day_name_en, "üåü –û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø—Ä–æ–±–µ–∂–∫–∏!")


def get_random_welcome() -> str:
    return random.choice(WELCOME_MESSAGES)


def get_random_motivation() -> str:
    return random.choice(MOTIVATION_QUOTES)


def get_random_insult() -> str:
    return random.choice(FUNNY_INSULTS)


def get_random_compliment() -> str:
    return random.choice(FUNNY_COMPLIMENTS)


# ============== –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò ==============
def update_daily_stats(user_id: int, user_name: str, message_type: str, photo_info: dict = None):
    """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
    global daily_stats
    
    today = datetime.now(MOSCOW_TZ).strftime("%Y-%m-%d")
    
    # –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–Ω—è
    if daily_stats["date"] != today:
        daily_stats = {
            "date": today,
            "total_messages": 0,
            "user_messages": {},
            "photos": [],
        }
    
    daily_stats["total_messages"] += 1
    
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_id not in daily_stats["user_messages"]:
        daily_stats["user_messages"][user_id] = {
            "name": user_name,
            "count": 0,
        }
    daily_stats["user_messages"][user_id]["count"] += 1
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    if message_type == "photo" and photo_info:
        daily_stats["photos"].append(photo_info)


async def send_morning_greeting():
    global morning_message_id

    if application is None:
        logger.error("Application –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        return

    try:
        weather = await get_weather()
        theme = get_day_theme()
        motivation = get_random_motivation()

        greeting_text = (
            f"üåÖ **–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –±–µ–≥—É–Ω—ã!** üèÉ‚Äç‚ôÇÔ∏è\n\n"
            f"{weather}\n\n"
            f"{theme}\n\n"
            f"{motivation}\n\n"
            f"üí≠ *–ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –ø–ª–∞–Ω—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!*"
        )

        message = await application.bot.send_message(
            chat_id=CHAT_ID,
            text=greeting_text,
            parse_mode="Markdown",
        )

        morning_message_id = message.message_id
        logger.info(f"–£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {morning_message_id}")

    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")


async def morning_scheduler_task():
    global morning_scheduled_date

    while bot_running:
        now = datetime.now(MOSCOW_TZ)
        current_hour = now.hour
        current_minute = now.minute
        today_date = now.strftime("%Y-%m-%d")

        if current_hour == 6 and current_minute == 0:
            if morning_scheduled_date != today_date:
                logger.info("–í—Ä–µ–º—è 6:00 - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                try:
                    await send_morning_greeting()
                    morning_scheduled_date = today_date
                    logger.info("–£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: {e}")

        await asyncio.sleep(60)


# ============== –ú–û–¢–ò–í–ê–¶–ò–û–ù–ù–´–ï –°–û–û–ë–©–ï–ù–ò–Ø ==============
async def send_motivation():
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
    if application is None:
        return

    try:
        motivation = get_random_motivation()
        message = await application.bot.send_message(
            chat_id=CHAT_ID,
            text=f"üí™ {motivation}",
            parse_mode="Markdown",
        )
        logger.info(f"–ú–æ—Ç–∏–≤–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: {message.message_id}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏: {e}")


async def motivation_scheduler_task():
    """–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ 11:00, 16:00, 21:00"""
    global motivation_sent_times
    
    while bot_running:
        now = datetime.now(MOSCOW_TZ)
        current_hour = now.hour
        current_minute = now.minute
        today_date = now.strftime("%Y-%m-%d")
        
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–æ–ª–Ω–æ—á—å
        if now.hour == 0 and current_minute == 0:
            motivation_sent_times = []
        
        # –í—Ä–µ–º—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏
        motivation_hours = [11, 16, 21]  # 11:00, 16:00, 21:00
        
        for hour in motivation_hours:
            if current_hour == hour and current_minute == 0:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –ª–∏ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è –≤ —ç—Ç–æ –≤—Ä–µ–º—è
                key = f"{today_date}_{hour}"
                if key not in motivation_sent_times:
                    logger.info(f"–í—Ä–µ–º—è {hour}:00 - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–æ—Ç–∏–≤–∞—Ü–∏—é")
                    try:
                        await send_motivation()
                        motivation_sent_times.append(key)
                        logger.info("–ú–æ—Ç–∏–≤–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞")
                    except Exception as e:
                        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏: {e}")
        
        await asyncio.sleep(60)


# ============== –ï–ñ–ï–î–ù–ï–í–ù–ê–Ø –°–í–û–î–ö–ê ==============
async def get_top_liked_photos() -> list:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø —Ñ–æ—Ç–æ –ø–æ –ª–∞–π–∫–∞–º"""
    global daily_stats
    
    if not daily_stats["photos"]:
        return []
    
    try:
        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ
        updated_photos = []
        for photo in daily_stats["photos"]:
            try:
                reactions = await application.bot.get_message_reactions(
                    chat_id=CHAT_ID,
                    message_id=photo["message_id"],
                )
                # –°—á–∏—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ reaction "üëç" (thumbs up)
                like_count = 0
                for reaction in reactions:
                    for choice in reaction.choices:
                        if choice.emoji == "üëç":
                            like_count = choice.count
                            break
                
                updated_photos.append({
                    "file_id": photo["file_id"],
                    "user_id": photo["user_id"],
                    "likes": like_count,
                    "message_id": photo["message_id"],
                })
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–π –¥–ª—è —Ñ–æ—Ç–æ {photo['message_id']}: {e}")
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                updated_photos.append(photo)
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ª–∞–π–∫–∞–º –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º (–º–∏–Ω–∏–º—É–º 4)
        updated_photos.sort(key=lambda x: x["likes"], reverse=True)
        top_photos = [p for p in updated_photos if p["likes"] >= 4]
        
        return top_photos[:2]  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∞–∫—Å–∏–º—É–º 2 —Ñ–æ—Ç–æ
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø —Ñ–æ—Ç–æ: {e}")
        return []


async def get_top_users() -> list:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    global daily_stats
    
    if not daily_stats["user_messages"]:
        return []
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–æ–±—â–µ–Ω–∏–π
    sorted_users = sorted(
        daily_stats["user_messages"].items(),
        key=lambda x: x[1]["count"],
        reverse=True
    )
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø 5
    return [(user_id, data["name"], data["count"]) for user_id, data in sorted_users[:5]]


async def send_daily_summary():
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–≤–æ–¥–∫–∏"""
    global daily_summary_sent
    
    if application is None or daily_summary_sent:
        return
    
    try:
        today = datetime.now(MOSCOW_TZ).strftime("%Y-%m-%d")
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–≤–æ–¥–∫–∏
        summary_text = f"üìä **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –∑–∞ {today}**\n\n"
        
        # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
        summary_text += f"üí¨ **–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π:** {daily_stats['total_messages']}\n\n"
        
        # –¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        top_users = await get_top_users()
        if top_users:
            summary_text += "üèÜ **–¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –±–µ–≥—É–Ω–æ–≤:**\n"
            medals = ["ü•á", "ü•à", "ü•â", "4Ô∏è‚É£", "5Ô∏è‚É£"]
            for i, (user_id, name, count) in enumerate(top_users):
                summary_text += f"{medals[i]} {name} ‚Äî {count} —Å–æ–æ–±—â–µ–Ω–∏–π\n"
            summary_text += "\n"
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤—É—é —á–∞—Å—Ç—å
        await application.bot.send_message(
            chat_id=CHAT_ID,
            text=summary_text,
            parse_mode="Markdown",
        )
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ø —Ñ–æ—Ç–æ
        top_photos = await get_top_liked_photos()
        if top_photos:
            for photo in top_photos:
                try:
                    await application.bot.send_photo(
                        chat_id=CHAT_ID,
                        photo=photo["file_id"],
                        caption=f"‚ù§Ô∏è {photo['likes']} –ª–∞–π–∫–æ–≤",
                        parse_mode="Markdown",
                    )
                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ: {e}")
        
        daily_summary_sent = True
        logger.info("–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞")
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–≤–æ–¥–∫–∏: {e}")
                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ: {e}")
        
        daily_summary_sent = True
        logger.info("–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞")
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–≤–æ–¥–∫–∏: {e}")


async def daily_summary_scheduler_task():
    """–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–≤–æ–¥–∫–∏ –≤ 23:59"""
    global daily_summary_sent
    
    while bot_running:
        now = datetime.now(MOSCOW_TZ)
        current_hour = now.hour
        current_minute = now.minute
        today_date = now.strftime("%Y-%m-%d")
        
        # –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –ø–æ–ª–Ω–æ—á—å
        if now.hour == 0 and current_minute == 0:
            daily_summary_sent = False
        
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–≤–æ–¥–∫–∏ –≤ 23:59
        if current_hour == 23 and current_minute == 59:
            if not daily_summary_sent:
                logger.info("–í—Ä–µ–º—è 23:59 - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Å–≤–æ–¥–∫—É")
                try:
                    await send_daily_summary()
                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–≤–æ–¥–∫–∏: {e}")
        
        await asyncio.sleep(60)


# ============== –ê–ù–û–ù–ò–ú–ù–ê–Ø –û–¢–ü–†–ê–í–ö–ê ==============
async def anon(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id
    user_anon_state[user_id] = "waiting_for_text"

    try:
        await update.message.delete()
    except Exception:
        pass


async def anonphoto(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id
    user_anon_state[user_id] = "waiting_for_photo"

    try:
        await update.message.delete()
    except Exception:
        pass


async def handle_anon_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id

    if user_id not in user_anon_state:
        return

    if user_anon_state[user_id] == "waiting_for_text":
        text = update.message.text
        target_mention = ""
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ @–Ω–∏–∫–Ω–µ–π–º –≤ –Ω–∞—á–∞–ª–µ
        import re
        match = re.match(r'^@(\w+)\s+(.+)', text)
        
        if match:
            target_username = match.group(1)
            message_text = match.group(2)
            target_mention = f"@{target_username}"
        else:
            message_text = text
        
        try:
            await update.message.delete()
        except Exception:
            pass

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        if target_mention:
            anon_text = f"üì¨ **–ê–Ω–æ–Ω–∏–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è {target_mention}:**\n\n{message_text}"
        else:
            anon_text = f"üì¨ **–ê–Ω–æ–Ω–∏–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:**\n\n{message_text}"
        
        await context.bot.send_message(
            chat_id=CHAT_ID,
            text=anon_text,
            parse_mode="Markdown",
        )

        del user_anon_state[user_id]


async def handle_anon_photo(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id

    if user_id not in user_anon_state:
        return

    if user_anon_state[user_id] == "waiting_for_photo":
        photo = update.message.photo[-1]

        try:
            await update.message.delete()
        except Exception:
            pass

        await context.bot.send_photo(
            chat_id=CHAT_ID,
            photo=photo.file_id,
            caption="üì¨ **–ê–Ω–æ–Ω–∏–º–Ω–æ–µ —Ñ–æ—Ç–æ**",
            parse_mode="Markdown",
        )

        del user_anon_state[user_id]


# ============== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–û–ë–©–ï–ù–ò–ô –î–õ–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ò ==============
async def handle_all_messages(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
    global night_messages_count, night_warning_sent, user_last_active
    
    if not update.message or not update.effective_chat:
        return
    
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—ã
    if update.message.text and update.message.text.startswith('/'):
        return
    
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–æ–≤
    if update.message.from_user.is_bot:
        return
    
    user = update.message.from_user
    user_id = user.id
    user_name = f"@{user.username}" if user.username else user.full_name
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—Ü–∞ (–Ω–µ –ø–∏—Å–∞–ª 2+ –Ω–µ–¥–µ–ª–∏)
    now = datetime.now(MOSCOW_TZ)
    two_weeks_ago = now - timedelta(days=14)
    
    if user_id in user_last_active:
        last_active = user_last_active[user_id]
        if last_active < two_weeks_ago:
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—Ü—É
            greeting = random.choice(RETURN_GREETINGS)
            try:
                await context.bot.send_message(
                    chat_id=CHAT_ID,
                    text=greeting,
                )
                logger.info(f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—Ü—É {user_name}")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è: {e}")
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    user_last_active[user_id] = now
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–ø–æ—Å–ª–µ 22:00)
    now = datetime.now(MOSCOW_TZ)
    if now.hour >= 22 and now.hour < 24:
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –≤ –ø–æ–ª–Ω–æ—á—å
        if now.hour == 0:
            night_messages_count = 0
            night_warning_sent = False
        
        # –°—á–∏—Ç–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ 22:00
        night_messages_count += 1
        
        # –ï—Å–ª–∏ –Ω–∞–±—Ä–∞–ª–æ—Å—å 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—â—ë –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏
        if night_messages_count >= 10 and not night_warning_sent:
            warning = random.choice(NIGHT_WARNINGS)
            try:
                await context.bot.send_message(
                    chat_id=CHAT_ID,
                    text=warning,
                )
                night_warning_sent = True
                logger.info("–ù–æ—á–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ—á–Ω–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: {e}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ñ–æ—Ç–æ
    photo_info = None
    if update.message.photo:
        photo = update.message.photo[-1]
        photo_info = {
            "file_id": photo.file_id,
            "user_id": user.id,
            "likes": 0,
            "message_id": update.message.message_id,
        }
    
    update_daily_stats(user.id, user_name, "photo" if update.message.photo else "text", photo_info)


async def handle_callback_query(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ callback-–∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–µ–∞–∫—Ü–∏–π)"""
    # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    # Telegram Bot API –Ω–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∞–∫—Ü–∏—è—Ö –≤ callback
    pass


# ============== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ==============
START_MESSAGE = """üèÉ **–ë–æ—Ç –¥–ª—è –±–µ–≥–æ–≤–æ–≥–æ —á–∞—Ç–∞**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
‚Ä¢ 06:00 ‚Äî –£—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –ø–æ–≥–æ–¥–∞ + —Ç–µ–º–∞ –¥–Ω—è
‚Ä¢ 11:00 ‚Äî –ú–æ—Ç–∏–≤–∞—Ü–∏—è
‚Ä¢ 16:00 ‚Äî –ú–æ—Ç–∏–≤–∞—Ü–∏—è
‚Ä¢ 21:00 ‚Äî –ú–æ—Ç–∏–≤–∞—Ü–∏—è
‚Ä¢ 22:00+ ‚Äî –ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º (–ø–æ—Å–ª–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Å–ø–∞—Ç—å)
‚Ä¢ 23:59 ‚Äî –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞
‚Ä¢ –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –ø–æ—Å–ª–µ 2+ –Ω–µ–¥–µ–ª—å ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç –±–æ—Ç–∞

**–ö–æ–º–∞–Ω–¥—ã:**
‚Ä¢ /start ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ /morning ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–µ–π—á–∞—Å
‚Ä¢ /stopmorning ‚Äî —É–¥–∞–ª–∏—Ç—å —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ /anon @–Ω–∏–∫–Ω–µ–π–º —Ç–µ–∫—Å—Ç ‚Äî –∞–Ω–æ–Ω–∏–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ /anonphoto ‚Äî –∞–Ω–æ–Ω–∏–º–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ
‚Ä¢ /remen ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Ä—Ü–∏—é —Å–º–µ—à–Ω—ã—Ö —Ä—É–≥–∞—Ç–µ–ª—å—Å—Ç–≤
‚Ä¢ /antiremen ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Ä—Ü–∏—é —Å–º–µ—à–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤
‚Ä¢ /summary ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–¥–∫—É –∑–∞ —Å–µ–≥–æ–¥–Ω—è"""


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await context.bot.send_message(
        chat_id=update.effective_chat.id,
        text=START_MESSAGE,
    )

    try:
        await update.message.delete()
    except Exception:
        pass


async def morning(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await send_morning_greeting()

    try:
        await update.message.delete()
    except Exception:
        pass


async def stopmorning(update: Update, context: ContextTypes.DEFAULT_TYPE):
    global morning_message_id

    if morning_message_id is not None:
        try:
            await application.bot.delete_message(
                chat_id=CHAT_ID,
                message_id=morning_message_id,
            )
            await context.bot.send_message(
                chat_id=update.effective_chat.id,
                text="‚òÄÔ∏è –£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ!",
            )
            morning_message_id = None
        except Exception:
            await context.bot.send_message(
                chat_id=update.effective_chat.id,
                text="‚ùå –£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ —É–∂–µ —É–¥–∞–ª–µ–Ω–æ!",
            )
    else:
        await context.bot.send_message(
            chat_id=update.effective_chat.id,
            text="‚ùå –£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!",
        )

    try:
        await update.message.delete()
    except Exception:
        pass


async def remen(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö —Ä—É–≥–∞—Ç–µ–ª—å—Å—Ç–≤"""
    insult = get_random_insult()
    
    await context.bot.send_message(
        chat_id=update.effective_chat.id,
        text=f"üòÑ **{insult}**",
        parse_mode="Markdown",
    )

    try:
        await update.message.delete()
    except Exception:
        pass


async def antiremen(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤"""
    compliment = get_random_compliment()
    
    await context.bot.send_message(
        chat_id=update.effective_chat.id,
        text=f"üíñ **{compliment}**",
        parse_mode="Markdown",
    )

    try:
        await update.message.delete()
    except Exception:
        pass


async def summary(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–≤–æ–¥–∫–∏ –ø–æ –∫–æ–º–∞–Ω–¥–µ"""
    await send_daily_summary()
    
    try:
        await update.message.delete()
    except Exception:
        pass


async def welcome_new_member(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not update.message or not update.message.new_chat_members:
        return

    try:
        bot_info = await context.bot.get_me()
        bot_id = bot_info.id
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ID –±–æ—Ç–∞: {e}")
        bot_id = None

    for member in update.message.new_chat_members:
        if member.is_bot or (bot_id and member.id == bot_id):
            continue

        welcome = get_random_welcome()
        try:
            if member.username:
                mention = f"@{member.username}"
            else:
                mention = member.full_name

            await context.bot.send_message(
                chat_id=update.effective_chat.id,
                text=f"{mention} {welcome}",
            )
            logger.info(f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {member.id}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è: {e}")


# ============== KEEP-ALIVE ==============
def keep_alive_pinger():
    """–ü–∏–Ω–≥–æ–≤–∞–Ω–∏–µ –¥–ª—è keep-alive"""
    while bot_running:
        try:
            time.sleep(300)
            if RENDER_URL and RENDER_URL != "YOUR_RENDER_URL_HERE":
                response = httpx.get(f"{RENDER_URL}/health", timeout=30)
                if response.status_code == 200:
                    logger.info(f"Ping successful: {RENDER_URL}/health")
                else:
                    logger.warning(f"Ping returned status {response.status_code}")
        except Exception:
            pass


if __name__ == "__main__":
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    
    def stop_all():
        global bot_running
        bot_running = False
        if application:
            application.stop()
        sys.exit(0)
    
    signal.signal(signal.SIGTERM, stop_all)
    signal.signal(signal.SIGINT, stop_all)
    
    flask_thread = threading.Thread(target=run_flask, daemon=True)
    flask_thread.start()
    logger.info("Flask –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 10000")
    
    application = (
        ApplicationBuilder()
        .token(BOT_TOKEN)
        .concurrent_updates(True)
        .build()
    )
    
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("morning", morning))
    application.add_handler(CommandHandler("stopmorning", stopmorning))
    application.add_handler(CommandHandler("remen", remen))
    application.add_handler(CommandHandler("antiremen", antiremen))
    application.add_handler(CommandHandler("summary", summary))
    application.add_handler(CommandHandler("anon", anon))
    application.add_handler(CommandHandler("anonphoto", anonphoto))
    application.add_handler(
        MessageHandler(filters.TEXT & ~filters.COMMAND, handle_anon_text)
    )
    application.add_handler(
        MessageHandler(filters.PHOTO & ~filters.COMMAND, handle_anon_photo)
    )
    application.add_handler(
        MessageHandler(filters.ALL & ~filters.COMMAND & ~filters.StatusUpdate.NEW_CHAT_MEMBERS, handle_all_messages)
    )
    application.add_handler(CallbackQueryHandler(handle_callback_query))
    application.add_handler(
        MessageHandler(filters.StatusUpdate.NEW_CHAT_MEMBERS, welcome_new_member)
    )
    
    loop.create_task(morning_scheduler_task())
    loop.create_task(motivation_scheduler_task())
    loop.create_task(daily_summary_scheduler_task())
    
    pinger_thread = threading.Thread(target=keep_alive_pinger, daemon=True)
    pinger_thread.start()
    
    logger.info("–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ –∑–∞–ø—É—â–µ–Ω—ã")
    
    application.run_polling(drop_pending_updates=True)
